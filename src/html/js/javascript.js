/*! jQuery UI - v1.11.2 - 2015-01-14
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, sortable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var s=0,n=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,a=n.call(arguments,1),o=0,r=a.length;r>o;o++)for(i in a[o])s=a[o][i],a[o].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(a){var o="string"==typeof a,r=n.call(arguments,1),h=this;return a=!o&&r.length?e.widget.extend.apply(null,[a].concat(r)):a,o?this.each(function(){var i,n=e.data(this,s);return"instance"===a?(h=n,!1):n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(i=n[a].apply(n,r),i!==n&&void 0!==i?(h=i&&i.jquery?h.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,s);t?(t.option(a||{}),t._init&&t._init()):e.data(this,s,new i(a,this))}),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var a=!1;e(document).mouseup(function(){a=!1}),e.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!a){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),a=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),a=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])
},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})});/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
jQuery.extend({stringify:function stringify(e){if("JSON" in window){return JSON.stringify(e)}var d=typeof(e);if(d!="object"||e===null){if(d=="string"){e='"'+e+'"'}return String(e)}else{var f,b,c=[],a=(e&&e.constructor==Array);for(f in e){b=e[f];d=typeof(b);if(e.hasOwnProperty(f)){if(d=="string"){b='"'+b+'"'}else{if(d=="object"&&b!==null){b=jQuery.stringify(b)}}c.push((a?"":'"'+f+'":')+String(b))}}return(a?"[":"{")+String(c)+(a?"]":"}")}}});if(window.MozWebSocket){window.WebSocket=window.MozWebSocket}(function(a,e){a.rpijs={};a.rpijs.rates={};a.rpijs.defaults={update:0,rate:false,format:[]};a.rpijs.formatDefaults={key:[],rate:false,valueType:"none",decimals:2};a.rpijs.init=function(g,h,f){a.rpijs.apiUrl=g;a.rpijs.username=h;a.rpijs.password=f};var b=function(){return"Basic "+btoa(a.rpijs.username+":"+a.rpijs.password)};a.rpijs.get=function(g,i,f){var h=a.extend({},a.rpijs.defaults,f);if(h.rate){c(g,i,f);return}a.ajax({url:a.rpijs.apiUrl+g,headers:{Authorization:b()}}).done(function(k){var j=i(d(k,g,f));if(j&&h.update!=0){setTimeout(function(){a.rpijs.get(g,i,f)},h.update)}})};a.rpijs.post=function(f,g,h){return a.ajax({url:a.rpijs.apiUrl+f,headers:{Authorization:b()},type:"POST",data:a.stringify(g),contentType:"application/json"}).done(h)};a.rpijs.websocket=function(f,i){if(window.WebSocket===e){return e}var h="";if(location.protocol=="https:"){h+="wss://"}else{h+="ws://"}h+=location.host+location.pathname+a.rpijs.apiUrl+f;document.cookie="RPiAuthorization="+b();var g=new WebSocket(h);if(i!==e){g.onmessage=function(j){i(a.parseJSON(j.data))}}return g};var d=function(f,i,h){var j=a.extend({},a.rpijs.defaults,h);if(typeof f!=="object"){var k=a.extend({},a.rpijs.formatDefaults,j.format[0]);if(typeof f==="number"&&k.rate){f=(f-a.rpijs.rates[i].object)/(a.now()-a.rpijs.rates[i].time)*1000}return a.rpijs.parseNumber(f,j.format[0])}var g=a.extend(true,{},f);a.each(j.format,function(m,q){var r=a.extend({},a.rpijs.formatDefaults,q);var p=g;var o;for(o=0;o<r.key.length-1;o++){p=p[r.key[o]]}var n=r.key[o];if(typeof p[n]==="number"&&r.rate){var l=a.rpijs.rates[i].object;a.each(r.key,function(s,t){l=l[t]});p[n]=(p[n]-l)/(a.now()-a.rpijs.rates[i].time)*1000}p[n]=a.rpijs.parseNumber(p[n],q)});return g};a.rpijs.parseNumber=function(q,h){var g=a.extend({},a.rpijs.formatDefaults,h);if(typeof q!=="number"||g.valueType==="none"){return q}else{var k,n;if(g.valueType=="decimal"){k=1000;n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"]}else{if(g.valueType=="binary"){k=1024;n=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]}else{if(g.valueType=="time"){var p=q;var m="";if(p>60){var j=Math.floor(p/60);p=p%60;if(j>60){var o=Math.floor(j/60);j=j%60;if(o>24){m+=Math.floor(o/24)+" days ";o=o%24}m+=o+" hours "}m+=j+" min "}m+=p.toFixed(g.decimals)+" s";return m}else{return q.toFixed(g.decimals)}}}var f="";if(g.rate){f="/s"}var l=0;while(q>=k){q/=k;l++}return q.toFixed(g.decimals)+" "+n[l]+f}};var c=function(g,j,f){var i=a.extend({},a.rpijs.defaults,f);var h={update:0,rate:false,format:[{key:[],rate:false,valueType:"none"}]};a.rpijs.get(g,function(l){if(a.rpijs.rates[g]===e){setTimeout(function(){c(g,j,f)},500)}else{var k=j(d(l,g,f));if(k&&i.update!=0){setTimeout(function(){c(g,j,f)},i.update)}}a.rpijs.rates[g]={object:l,time:a.now()}},h)};a.fn.rpijs=function(g,f){return this.each(function(){var h=this;a.rpijs.get(g,function(i){if(typeof i==="object"){i=JSON.stringify(i)}a(h).html(i);return true},f)})}}(jQuery));
(function(a,c,b){b.module("googlechart",[]).constant("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).provider("googleJsapiUrl",function(){var e="https:";var d="//www.google.com/jsapi";this.setProtocol=function(f){e=f};this.setUrl=function(f){d=f};this.$get=function(){return(e?e:"")+d}}).factory("googleChartApiPromise",["$rootScope","$q","googleChartApiConfig","googleJsapiUrl",function(d,h,g,k){var e=h.defer();var j=function(){var l={callback:function(){var m=g.optionalSettings.callback;d.$apply(function(){e.resolve()});if(b.isFunction(m)){m.call(this)}}};l=b.extend({},g.optionalSettings,l);c.google.load("visualization",g.version,l)};var i=a.getElementsByTagName("head")[0];var f=a.createElement("script");f.setAttribute("type","text/javascript");f.src=k;if(f.addEventListener){f.addEventListener("load",j,false)}else{f.onreadystatechange=function(){if(f.readyState==="loaded"||f.readyState==="complete"){f.onreadystatechange=null;j()}}}i.appendChild(f);return e.promise}]).directive("googleChart",["$timeout","$window","$rootScope","googleChartApiPromise",function(e,g,d,f){return{restrict:"A",scope:{chart:"=chart",onReady:"&",onSelect:"&",select:"&"},link:function(k,j,i){k.$watch(function(){if(k.chart){return{data:k.chart.data,formatters:k.chart.formatters,options:k.chart.options,type:k.chart.type,customFormatters:k.chart.customFormatters}}return k.chart},function(){l()},true);d.$on("resizeMsg",function(){e(function(){if(k.chartWrapper){l()}})});k.oldChartFormatters={};function m(t,n,s){if(typeof(k.chart.formatters[t])!="undefined"){if(!b.equals(k.chart.formatters[t],k.oldChartFormatters[t])){k.oldChartFormatters[t]=k.chart.formatters[t];k.formatters[t]=[];if(t==="color"){for(var r=0;r<k.chart.formatters[t].length;r++){var p=new n();for(o=0;o<k.chart.formatters[t][r].formats.length;o++){var q=k.chart.formatters[t][r].formats[o];if(typeof(q.fromBgColor)!="undefined"&&typeof(q.toBgColor)!="undefined"){p.addGradientRange(q.from,q.to,q.color,q.fromBgColor,q.toBgColor)}else{p.addRange(q.from,q.to,q.color,q.bgcolor)}}k.formatters[t].push(p)}}else{for(var o=0;o<k.chart.formatters[t].length;o++){k.formatters[t].push(new n(k.chart.formatters[t][o]))}}}for(o=0;o<k.formatters[t].length;o++){if(k.chart.formatters[t][o].columnNum<s.getNumberOfColumns()){k.formatters[t][o].format(s,k.chart.formatters[t][o].columnNum)}}if(t==="arrow"||t==="bar"||t==="color"){k.chart.options.allowHtml=true}}}function h(){if(!h.triggered&&(k.chart!=undefined)){h.triggered=true;e(function(){if(typeof(k.chartWrapper)=="undefined"){var o={chartType:k.chart.type,dataTable:k.chart.data,view:k.chart.view,options:k.chart.options,containerId:j[0]};k.chartWrapper=new google.visualization.ChartWrapper(o);google.visualization.events.addListener(k.chartWrapper,"ready",function(){k.chart.displayed=true;k.$apply(function(q){q.onReady({chartWrapper:q.chartWrapper})})});google.visualization.events.addListener(k.chartWrapper,"error",function(q){console.log("Chart not displayed due to error: "+q.message+". Full error object follows.");console.log(q)});google.visualization.events.addListener(k.chartWrapper,"select",function(){var q=k.chartWrapper.getChart().getSelection()[0];k.$apply(function(){if(i.select){console.log("Angular-Google-Chart: The 'select' attribute is deprecated and will be removed in a future release.  Please use 'onSelect'.");k.select({selectedItem:q})}else{k.onSelect({selectedItem:q})}})})}else{k.chartWrapper.setChartType(k.chart.type);k.chartWrapper.setDataTable(k.chart.data);k.chartWrapper.setView(k.chart.view);k.chartWrapper.setOptions(k.chart.options)}if(typeof(k.formatters)==="undefined"){k.formatters={}}if(typeof(k.chart.formatters)!="undefined"){m("number",google.visualization.NumberFormat,k.chartWrapper.getDataTable());m("arrow",google.visualization.ArrowFormat,k.chartWrapper.getDataTable());m("date",google.visualization.DateFormat,k.chartWrapper.getDataTable());m("bar",google.visualization.BarFormat,k.chartWrapper.getDataTable());m("color",google.visualization.ColorFormat,k.chartWrapper.getDataTable())}var p=k.chart.customFormatters;if(typeof(p)!="undefined"){for(var n in p){m(n,p[n],k.chartWrapper.getDataTable())}}e(function(){k.chartWrapper.draw();h.triggered=false})},0,true)}}function l(){f.then(function(){h()})}}}}]).run(["$rootScope","$window",function(d,e){b.element(e).bind("resize",function(){d.$emit("resizeMsg")})}])})(document,window,window.angular);
rpiDashboard=angular.module("rpiDashboard",["ngRoute","ngCookies","googlechart"]);registerPage=function(a){rpiDashboard.config(["$routeProvider",function(b){b.when(a.path,a.route)}]);rpiDashboard.run(["Navigation",function(b){b.register(a.path,a.accessDependencies,a.title,a.description)}])};backgroundUpdate=function(c,a,b){rpiDashboard.run(["$rootScope","User","$timeout","$q",function(d,h,f,e){var g=function(){if(!h.checkDependencies(c)){return}var i=e.defer();b(i);i.promise.then(function(){if(a!=0){f(g,a)}})};d.$on("USER_STATUS_CHANGED",function(){g()});g()}])};vObject=function(b,a){var c={v:b};if(a!==undefined){c.f=a(b)}return c};cObject=function(a){return{c:a}};rpiDashboard.config(["$routeProvider",function(a){a.otherwise({redirectTo:"/"})}]);var bytesFilter=function(b,a){return $.rpijs.parseNumber(b,{valueType:"binary",decimals:a})};rpiDashboard.filter("bytes",function(){return bytesFilter});var bpsFilter=function(b,a){return $.rpijs.parseNumber(b,{valueType:"binary",rate:true,decimals:a})};rpiDashboard.filter("bps",function(){return bpsFilter});var procentsFilter=function(b,a){if(isNaN(parseFloat(b))||!isFinite(b)){return"-"}if(typeof a==="undefined"){a=1}return(100*b).toFixed(a)+"%"};rpiDashboard.filter("procents",function(){return procentsFilter});var celsiusFilter=function(b,a){if(isNaN(parseFloat(b))||!isFinite(b)){return"-"}if(typeof a==="undefined"){a=1}return b.toFixed(a)+"°C"};rpiDashboard.filter("time",function(){return function(a){return $.rpijs.parseNumber(a,{valueType:"time",decimals:0})}});
historyGraph=function(j,k,g,a,b,f){k.unshift({id:"time",label:"Time",type:"datetime"});var e={};e.graphs=[{name:"minute",length:60,step:1,type:j,data:{cols:k,rows:[],},options:{backgroundColor:{fill:"transparent"},legend:"none",chartArea:{top:10,left:70,width:"85%",height:"85%"},vAxis:{ticks:[]}},max:1,}];angular.extend(e.graphs[0].options,g);e.graphs.push(angular.copy(e.graphs[0]));e.graphs[1].name="hour";e.graphs[1].length=3600;e.graphs[1].step=60;e.graphs.push(angular.copy(e.graphs[0]));e.graphs[2].name="day";e.graphs[2].length=86400;e.graphs[2].step=1800;e.graphs.push(angular.copy(e.graphs[0]));e.graphs[3].name="week";e.graphs[3].length=604800;e.graphs[3].step=10800;e.graphs.push(angular.copy(e.graphs[0]));e.graphs[4].name="month";e.graphs[4].length=2592000;e.graphs[4].step=43200;e.graphs.push(angular.copy(e.graphs[0]));e.graphs[5].name="year";e.graphs[5].length=31536000;e.graphs[5].step=525600;e.graph=e.graphs[0];var c=function(o){if(o.max==0){o.max=1}var n=Math.pow(2,Math.ceil(Math.log(o.max)/Math.LN2));o.options.vAxis.ticks=[{v:0,f:a(0,1)},{v:n/4,f:a(n/4,1)},{v:n/2,f:a(n/2,1)},{v:n*0.75,f:a(n*0.75,1)},{v:n,f:a(n,1)}]};var m=function(n,o){var p=false;if(e.graph.options.isStacked){value=0;for(i=1;i<o.c.length;i++){value+=o.c[i].v}if(value>n.max){n.max=value;p=true}}else{for(i=1;i<o.c.length;i++){if(o.c[i].v>n.max){n.max=o.c[i].v;p=true}}}n.data.rows.push(o);c(n)};var d=function(p,o,n){if(p===undefined){return true}if(o===undefined){return true}return((p.c[0].v-o.c[0].v)>=n*1000)};var l=function(n){return n[n.length-1]};var h=function(n){$.rpijs.get("logger/"+n.name+"?value="+b,function(q){if(f!==undefined){f(q)}n.max=0;if(n.options.isStacked){n.max=0;angular.forEach(q,function(s){for(i=0;i<s.data.length;i++){if(s.data[i]!==null){n.max+=s.data[i];break}}});n.max=Math.round(n.max)}else{angular.forEach(q,function(s){if(s.max>n.max){n.max=s.max}})}n.data.rows=[];var p=b.split("|")[0].replace(/\//g,"-");var o=q[p].start;for(i=0;o<=q[p].end;i++,o+=q[p].step){var r=cObject([vObject(new Date(o*1000)),]);angular.forEach(q,function(s){r.c.push(vObject(s.data[i],a))});n.data.rows.push(r)}c(n);n.options.hAxis={viewWindow:{min:new Date(q[p].start*1000),max:new Date(q[p].end*1000)}}})};e.add=function(n){row=cObject([vObject(new Date())]);angular.forEach(n,function(p){row.c.push(vObject(p,a))});m(e.graphs[0],row);var o=e.graphs[0].data;if(d(l(o.rows),o.rows[0],e.graphs[0].length)){o.rows.shift()}if(d(l(o.rows),l(e.graph.data.rows),e.graph.step)){h(e.graph)}};h(e.graphs[1]);h(e.graphs[2]);h(e.graphs[3]);h(e.graphs[4]);h(e.graphs[1]);return e};rpiDashboard.directive("historyChart",function(){return{scope:{hg:"=chart"},templateUrl:"partials/history.html"}});
rpiDashboard.factory("User",["$q","$cookies","$rootScope","$location",function(b,d,a,g){var c=[];var e=[];var f={loggedIn:false,username:null,goNext:"/",login:function(j,h,i){a.msgError="";if(j==undefined){j=""}if(h==undefined){h=""}$.rpijs.init("./api/",j,h);$.rpijs.get("",function(k){f.loggedIn=k.user!==null;f.username=k.user;c=k.modules;e=k["modules-write"];if(f.loggedIn||j==""){if(i){d.RPiUsername=j;d.RPiPassword=h}if(g.path()=="/login"){g.path(f.goNext)}}else{a.$apply(function(){a.msgError="Invalid username or password."})}a.$broadcast("USER_STATUS_CHANGED")})},logout:function(){d.RPiUsername="";d.RPiPassword="";a.msgError="";c=[];return f.login()},getModules:function(){return c},checkDependencies:function(h){var i=true;if(angular.isArray(h)){angular.forEach(h,function(k,j){if($.inArray(k,c)==-1){i=false}})}else{angular.forEach(h,function(k,j){if(k=="write"){if($.inArray(j,e)==-1||$.inArray(j,c)==-1){i=false}}else{if($.inArray(j,c)==-1){i=false}}})}return i}};f.login(d.RPiUsername,d.RPiPassword);return f}]);rpiDashboard.controller("LoginController",["$scope","User","$location","$cookies",function(a,d,c,b){a.rememberMe=true;a.loggedIn=d.loggedIn;a.user=d.username;a.login=function(){d.login(a.username,a.password,a.rememberMe)};a.logout=function(){d.logout()}}]);rpiDashboard.config(["$routeProvider",function(a){a.when("/login",{templateUrl:"partials/login.html",controller:"LoginController"})}]);rpiDashboard.run(["$rootScope","$location","Navigation","User",function(a,d,b,c){a.$on("$routeChangeStart",function(f,e,g){if(!c.checkDependencies(b.getDependencies())){if(c.loggedIn){a.msgError="You do not have permission to access '"+d.path()+"'."}f.preventDefault();if(e!==undefined){c.goNext=e.$$route.originalPath}d.path("/login")}});a.$on("USER_STATUS_CHANGED",function(){if(!c.checkDependencies(b.getDependencies())){c.goNext=d.path();d.path("/login");a.$apply()}})}]);
rpiDashboard.factory("Navigation",["$location","User",function(d,c){var a={};var b={};return{register:function(h,g,f,e){a[h]=g;if(e==undefined){e=""}b[h]={name:f,title:e,path:h}},registerDependencies:function(f,e){a[f]=e},getDependencies:function(){return a[d.path()]},getMenu:function(){var e=[];angular.forEach(b,function(f){if(c.checkDependencies(a[f.path])){e.push(f)}});return e},getMenuEntry:function(e){return b[e]}}}]);rpiDashboard.controller("NavigationController",["$scope","$location","User","Navigation",function(a,d,c,b){a.loggedIn=false;a.menu=[];a.$on("USER_STATUS_CHANGED",function(){a.loggedIn=c.loggedIn;a.menu=b.getMenu()});a.menuClass=function(e){var f=d.path().substring(1);return e.substring(1)===f?"active":""};a.logout=function(){c.logout()}}]);rpiDashboard.controller("TitleDescriptionController",["$scope","$location","Navigation","$rootScope",function(b,e,d,a){b.description="";b.title="";var c=function(){var f=d.getMenuEntry(e.path());if(f==undefined){b.titleShow=false;b.descriptionShow=false}else{if(f.name==undefined){b.titleShow=false}else{b.titleShow=true;b.title=f.name}if(f.title==undefined){b.descriptionShow=false}else{b.descriptionShow=true;b.description=f.title}}};c();a.$on("$routeChangeStart",function(){c()})}]);
rpiDashboard.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/main.html",controller:"MainController"})}]);rpiDashboard.run(["Navigation",function(a){a.registerDependencies("/",[])}]);mainData={};mainData.widgets=[];registerWidget=function(c,a,b,d){mainData.widgets.push({width:c,controller:a,partial:b,access:d})};rpiDashboard.controller("MainController",["$scope","User",function(b,c){var a=function(){var d=[];angular.forEach(mainData.widgets,function(e){if(c.checkDependencies(e.access)){d.push(e)}});b.widgets=d;$("#main-sort").sortable({handle:".panel-heading",placeholder:"col-sm-3 main-placeholder"});$("#main-sort").disableSelection()};b.$on("USER_STATUS_CHANGED",function(){b.loggedIn=c.loggedIn;a()});b.loggedIn=c.loggedIn;a()}]);
registerPage({path:"/cpu",route:{templateUrl:"partials/cpu.html",controller:"CpuController"},accessDependencies:["cpu","general","logger"],title:"CPU",description:"Show cpu usage and temperature with history graphs."});registerWidget(3,["$scope","$timeout",function(a,c){var b=function(){a.uptime++;b.timeout=c(b,1000)};$.rpijs.get("general/uptime",function(d){a.$apply(function(){a.uptime=d-1});b()});$.rpijs.get("general/board-rev",function(d){a.$apply(function(){a.boardrev=d})});a.$on("$destroy",function(){c.cancel(b.timeout)})}],"partials/widgets/general.html",["general"]);registerWidget(3,["$scope",function(a){a.cpuUsage=cpuData.usageGraph}],"partials/widgets/cpu-usage.html",["cpu"]);registerWidget(4,["$scope",function(a){a.temperatureGauge=cpuData.temperatureGauge}],"partials/widgets/cpu-temp.html",["cpu"]);cpuData={};cpuData.usage={user:vObject(0),system:vObject(0),iowait:vObject(0)};cpuData.temperature=vObject(0);cpuData.usageFetchFormat={rate:true,format:[{key:["total"],rate:true},{key:["system"],rate:true},{key:["user"],rate:true},{key:["iowait"],rate:true}]};cpuData.usageVAxis={ticks:[vObject(0,procentsFilter),vObject(0.5,procentsFilter),vObject(1,procentsFilter)]};cpuData.usageGraph={type:"ColumnChart",data:{cols:[{id:"cpu",type:"string"},{id:"user",label:"User processes",type:"number"},{id:"system",label:"System",type:"number"},{id:"iowait",label:"I/O wait",type:"number"}],rows:[cObject([vObject("Cpu"),cpuData.usage.user,cpuData.usage.system,cpuData.usage.iowait])]},options:{isStacked:true,backgroundColor:{fill:"transparent"},vAxis:cpuData.usageVAxis,legend:"none",chartArea:{top:10,width:"50%",height:"85%"},colors:["#dc3912","#ff9900","#3366cc"]}};cpuData.temperatureGauge={type:"Gauge",data:{cols:[{id:"temperature",label:"°C",type:"number"}],rows:[cObject([cpuData.temperature])]},options:{backgroundColor:{fill:"transparent"},min:0,max:100,redFrom:75,redTo:100,yellowFrom:60,yellowTo:75,minorTicks:5,majorTicks:[0,25,50,75,100]}};backgroundUpdate(["cpu","logger"],1000,function(a){if(cpuData.usageHistory===undefined){cpuData.usageHistory=historyGraph("AreaChart",[{id:"user",label:"User processes",type:"number"},{id:"system",label:"System",type:"number"},{id:"iowait",label:"I/O wait",type:"number"}],{isStacked:true,colors:["#dc3912","#ff9900","#3366cc"],lineWidth:1},procentsFilter,"cpu/usage/user|cpu/usage/system|cpu/usage/iowait|cpu/usage/total",function(c){var b=c["cpu-usage-total"];delete c["cpu-usage-total"];for(i=0;i<b.data.length;i++){angular.forEach(c,function(d){if(d.data[i]!=null){d.data[i]/=b.data[i]}})}});cpuData.temperatureHistory=historyGraph("LineChart",[{id:"temperature",label:"Temperature",type:"number"}],{},celsiusFilter,"cpu/temperature")}$.rpijs.get("cpu/usage",function(b){cpuData.usage.user.v=b.user/b.total;cpuData.usage.user.f=procentsFilter(cpuData.usage.user.v);cpuData.usage.system.v=(b.system)/b.total;cpuData.usage.system.f=procentsFilter(cpuData.usage.system.v);cpuData.usage.iowait.v=b.iowait/b.total;cpuData.usage.iowait.f=procentsFilter(cpuData.usage.iowait.v);cpuData.usageHistory.add([cpuData.usage.user.v,cpuData.usage.system.v,cpuData.usage.iowait.v]);$.rpijs.get("cpu/temperature",function(c){cpuData.temperature.v=c;cpuData.temperature.f=celsiusFilter(c);cpuData.temperatureHistory.add([c]);a.resolve()})},cpuData.usageFetchFormat)});rpiDashboard.controller("CpuController",["$scope","$timeout",function(a,c){var b=function(){a.uptime++;b.timeout=c(b,1000)};$.rpijs.get("general/uptime",function(d){a.$apply(function(){a.uptime=d-1});b()});a.cpuData=cpuData;a.$on("$destroy",function(){c.cancel(b.timeout)})}]);rpiDashboard.controller("CpuUsageWidgetController",["$scope",function(a){a.cpuUsage=cpuData.usageGraph}]);rpiDashboard.controller("CpuTemperatureWidgetController",["$scope",function(a){a.temperatureGauge=cpuData.temperatureGauge}]);
registerPage({path:"/memory",route:{templateUrl:"partials/memory.html",controller:"MemoryController"},accessDependencies:["memory","logger"],title:"Memory",description:"Show memory and swap usage with history graphs."});registerWidget(5,["$scope",function(a){a.ramChart=memoryData.ramChart;a.ramTotal=memoryData.memory.total}],"partials/widgets/ram-usage.html",["memory"]);memoryData={};memoryData.memory={total:vObject(0),total14:vObject(0),total24:vObject(0),total34:vObject(0),used:vObject(0),free:vObject(0),processes:vObject(0),buffers:vObject(0),cached:vObject(0)};memoryData.swap={total:vObject(0),total14:vObject(0),total24:vObject(0),total34:vObject(0),used:vObject(0),free:vObject(0)};memoryData.pieChartOptions={backgroundColor:{fill:"transparent"},is3D:true,legend:"none",colors:["#109618","#dc3912","#ff9900","#3366cc"],chartArea:{width:"90%",height:"90%"}};memoryData.ramChart={type:"PieChart",data:{cols:[{id:"label",type:"string"},{id:"size",type:"number"}],rows:[cObject([vObject("Free"),memoryData.memory.free]),cObject([vObject("Processes"),memoryData.memory.processes]),cObject([vObject("File buffers"),memoryData.memory.buffers]),cObject([vObject("I/O Cached"),memoryData.memory.cached])]},options:memoryData.pieChartOptions};memoryData.swapChart={type:"PieChart",data:{cols:[{id:"label",type:"string"},{id:"size",type:"number"}],rows:[cObject([vObject("Free"),memoryData.swap.free]),cObject([vObject("Used"),memoryData.swap.used])]},options:memoryData.pieChartOptions};backgroundUpdate(["memory","logger"],5000,function(a){if(memoryData.ramHistory===undefined){memoryData.ramHistory=historyGraph("AreaChart",[{id:"processes",label:"Processes",type:"number"},{id:"buffers",label:"File buffers",type:"number"},{id:"cached",label:"I/O Cached",type:"number"},{id:"free",label:"Free",type:"number"}],{isStacked:true,colors:["#dc3912","#ff9900","#3366cc","#109618"]},bytesFilter,"memory/processes|memory/buffers|memory/cached|memory/free");memoryData.swapHistory=historyGraph("AreaChart",[{id:"used",label:"Used",type:"number"},{id:"free",label:"Free",type:"number"}],{isStacked:true,colors:["#dc3912","#109618"],},bytesFilter,"memory/swap/used|memory/swap/free")}$.rpijs.get("memory",function(b){if(memoryData.memory.total.v==0){memoryData.memory.total.v=b.total;memoryData.memory.total.f=bytesFilter(b.total);memoryData.memory.total14.v=b.total/4;memoryData.memory.total14.f=bytesFilter(b.total/4);memoryData.memory.total24.v=b.total/2;memoryData.memory.total24.f=bytesFilter(b.total/2);memoryData.memory.total34.v=b.total*0.75;memoryData.memory.total34.f=bytesFilter(b.total*0.75);memoryData.swap.total.v=b.swap.total;memoryData.swap.total.f=bytesFilter(b.swap.total);memoryData.swap.total14.v=b.swap.total/4;memoryData.swap.total14.f=bytesFilter(b.swap.total/4);memoryData.swap.total24.v=b.swap.total/2;memoryData.swap.total24.f=bytesFilter(b.swap.total/2);memoryData.swap.total34.v=b.swap.total*0.75;memoryData.swap.total34.f=bytesFilter(b.swap.total*0.75)}memoryData.memory.used.v=b.used;memoryData.memory.free.v=b.free;memoryData.memory.free.f=bytesFilter(b.free);memoryData.memory.processes.v=b.processes;memoryData.memory.processes.f=bytesFilter(b.processes);memoryData.memory.buffers.v=b.buffers;memoryData.memory.buffers.f=bytesFilter(b.buffers);memoryData.memory.cached.v=b.cached;memoryData.memory.cached.f=bytesFilter(b.cached);memoryData.ramHistory.add([b.processes,b.buffers,b.cached,b.free]);memoryData.swap.free.v=b.swap.free;memoryData.swap.free.f=bytesFilter(b.swap.free);memoryData.swap.used.v=b.swap.used;memoryData.swap.used.f=bytesFilter(b.swap.used);memoryData.swapHistory.add([b.swap.used,b.swap.free]);a.resolve()})});rpiDashboard.controller("MemoryController",["$scope","$filter",function(a,b){a.memoryData=memoryData}]);
registerPage({path:"/network",route:{templateUrl:"partials/network.html",controller:"NetworkController"},accessDependencies:["network","logger"],title:"Network",description:"Show network configuration and usage with history graphs."});networkData={};networkData.list={};networkData.ready=false;networkData.throughputRequestOptions={rate:true,format:[]};backgroundUpdate(["network","logger"],1000,function(a){if(!networkData.ready){$.rpijs.get("network/list",function(b){angular.forEach(b,function(d,c){networkData.list[c]=d;networkData.throughputRequestOptions.format.push({key:["rx",c],rate:true});networkData.throughputRequestOptions.format.push({key:["tx",c],rate:true});networkData.list[c].throughput={rx:vObject(0),tx:vObject(0)};networkData.list[c].history=historyGraph("AreaChart",[{id:"tx",label:"Transmit",type:"number"},{id:"rx",label:"Receive",type:"number"}],{lineWidth:1},bpsFilter,"network/bytes/tx/"+c+"|network/bytes/rx/"+c)});networkData.ready=true;a.resolve()});return}$.rpijs.get("network/bytes",function(b){angular.forEach(b.rx,function(d,c){networkData.list[c].throughput.rx.v=d;networkData.list[c].throughput.rx.f=bpsFilter(d)});angular.forEach(b.tx,function(d,c){networkData.list[c].throughput.tx.v=d;networkData.list[c].throughput.tx.f=bpsFilter(d);networkData.list[c].history.add([networkData.list[c].throughput.tx.v,networkData.list[c].throughput.rx.v])});a.resolve()},networkData.throughputRequestOptions)});rpiDashboard.controller("NetworkController",["$scope",function(a){a.list=networkData.list}]);
registerPage({path:"/storage",route:{templateUrl:"partials/storage.html",controller:"StorageController"},accessDependencies:["storage","logger"],title:"Storage",description:"Show storage mount points with usage and throughput information with history graphs."});registerWidget(5,["$scope",function(a){a.storageRoot=angular.copy(memoryData.swapChart);a.storageRoot.data.rows=storageData.rootFS;a.storageRootTotalSize=storageData.rootTotalSize}],"partials/widgets/storage.html",["storage"]);storageData={};storageData.storageTable={type:"Table",data:{cols:[{id:"device",label:"Device",type:"string"},{id:"mount",label:"Mount point",type:"string"},{id:"filesystem",label:"Filesystem",type:"string"},{id:"size",label:"Size",type:"number"},{id:"used",label:"Used",type:"number"},{id:"use",label:"Use",type:"number"}],rows:[]},options:{},formatters:{bar:[{columnNum:5,max:1}]}};storageData.throughputRequest={rate:true,format:[]};storageData.rootFS=[cObject([vObject("Free")]),cObject([vObject("Used")])];storageData.rootTotalSize=vObject();backgroundUpdate(["storage","logger"],1000,function(a){if(storageData.throughputRequest.format.length==0){$.rpijs.get("storage/throughput",function(d){var c=[];var b="";angular.forEach(d,function(f,e){c.push({id:e,label:e,type:"number"});if(b.length!=0){b+="|"}b+="storage/throughput/"+e+"/total";storageData.throughputRequest.format.push({key:[e,"total"],rate:true})});storageData.throughputHistory=historyGraph("LineChart",c,{legend:"right",chartArea:{top:10,left:80,width:"65%",height:"85%"}},bpsFilter,b);a.resolve()});return}$.rpijs.get("storage/throughput",function(c){var b=[];angular.forEach(c,function(e,d){b.push(e.total)});storageData.throughputHistory.add(b);a.resolve()},storageData.throughputRequest)});backgroundUpdate(["storage","logger"],60000,function(a){$.rpijs.get("storage/list",function(b){storageData.storageTable.data.rows=[];angular.forEach(b,function(c){if(c.mount=="/"){storageData.rootFS[0].c[1]=vObject(c.size-c.used,bytesFilter);storageData.rootFS[1].c[1]=vObject(c.used,bytesFilter);storageData.rootTotalSize.v=c.size}storageData.storageTable.data.rows.push(cObject([vObject(c.device),vObject(c.mount),vObject(c.filesystem),vObject(c.size,bytesFilter),vObject(c.used,bytesFilter),vObject(c.use,procentsFilter)]))});a.resolve()})});rpiDashboard.controller("StorageController",["$scope",function(a){a.storageData=storageData}]);
registerPage({path:"/gpio",route:{templateUrl:"partials/gpio.html",controller:"GpioController"},accessDependencies:{gpio:"write",general:"read"},title:"GPIO",description:"Show and control GPIO pins of your Raspberry Pi."});GpioPinClass=function(a,b){this.id=a;this.mode=b.mode;this.pull=b.pull;this.pulls=["off","down","up"];this.value=b.value;this.range=b.range;this.frequency=b.frequency};GpioPinClass.prototype.getModes=function(){var a=["input","output","pwm","tone"];if(this.mode=="undefined"){a.unshift("undefined")}return a};GpioPinClass.prototype.modeChange=function(){$.rpijs.post("gpio/pins/"+this.id+"/mode",this.mode)};GpioPinClass.prototype.pullChange=function(){$.rpijs.post("gpio/pins/"+this.id+"/pull",this.pull)};GpioPinClass.prototype.pullShow=function(){return this.mode=="input"};GpioPinClass.prototype.valueChange=function(){if(this.value===null){return}if(typeof this.value!="number"){this.value=0}if(this.mode!="input"){$.rpijs.post("gpio/pins/"+this.id+"/value",this.value)}};GpioPinClass.prototype.valueReadonly=function(){return this.mode=="input"||this.mode=="undefined"};GpioPinClass.prototype.rangeChange=function(){if(this.range===null){return}if(typeof this.range!="number"){this.range=100}$.rpijs.post("gpio/pins/"+this.id+"/range",this.range);if(this.value>this.range){this.value=this.range}};GpioPinClass.prototype.rangeShow=function(){return this.mode=="pwm"};GpioPinClass.prototype.frequencyChange=function(){if(this.frequency===null){return}if(typeof this.frequency!="number"){this.frequency=1000}$.rpijs.post("gpio/pins/"+this.id+"/frequency",this.frequency)};GpioPinClass.prototype.frequencyShow=function(){if(this.mode=="pwm"&&this.id=="1"){return true}return this.mode=="tone"};GpioPinClass.prototype.frequencyMax=function(){if(this.mode=="pwm"){return 19200000}else{return 5000}};GpioPinClass.prototype.toggleShow=function(){return this.mode=="output"||this.mode=="tone"};GpioPinClass.prototype.toggleClick=function(){if(this.value>0){this.value=0}else{this.value=1}this.valueChange()};rpiDashboard.controller("GpioController",["$scope",function(b){b.pins=[];var c=true;var a=$.rpijs.websocket("gpio/ws",function(d){b.$apply(function(){angular.forEach(d,function(g,f){var e=parseInt(f);b.pins[e].value=g})})});if(a!==undefined){a.onopen=function(){c=false}}$.rpijs.get("gpio/pins",function(d){b.$apply(function(){if(b.pins.length==0){angular.forEach(d,function(f,e){b.pins.push(new GpioPinClass(e,f))})}else{angular.forEach(d,function(g,f){var e=parseInt(f);if(b.pins[e].mode=="input"||b.pins[e].mode=="undefined"){b.pins[e].value=g.value}})}});return c},{update:1000});b.$on("$destroy",function(){c=false;if(a!==undefined){a.close()}});b.pinoutLoad=function(){b.pinoutImageSource="http://wiringpi.com/wp-content/uploads/2013/03/gpio1.png";$.rpijs.get("general/board-rev",function(d){if(d==2){b.$apply(function(){b.pinoutSecondarySource="http://wiringpi.com/wp-content/uploads/2013/03/gpio21.png"})}})}}]);
registerPage({path:"/i2c",route:{templateUrl:"partials/i2c.html",controller:"I2CController"},accessDependencies:{i2c:"write"},title:"I2C",description:"Read and write to devices on I2C bus."});rpiDashboard.controller("I2CController",["$scope",function(a){a.address=96;a.actions=[{id:0,text:"Read"},{id:1,text:"Write"},{id:2,text:"Read 8-bit register"},{id:3,text:"Write 8-bit register"},{id:4,text:"Read 16-bit register"},{id:5,text:"Write 16-bit register"}];a.action=a.actions[0];a.register=0;a.registerShow=function(){return a.action.id>1};a.value=0;a.valueShow=function(){return a.action.id%2==1};a.valueMax=function(){if(a.action.id>3){return 65535}else{return 255}};a.buttonText=function(){if(a.action.id%2==1){return"Write!"}else{return"Read!"}};a.finished=false;var b=function(d){a.$apply(function(){if(d=="Successful!"){a.status="success"}else{a.status="warning"}a.statusText=d;a.finished=true})};var c=function(d){a.$apply(function(){if(typeof d=="number"){if(d<0){a.statusText="Unsuccessful read!";a.status="warning"}else{a.statusText="Value: "+d;a.status="success"}}else{a.statusText="Invalid address!";a.status="warning"}a.finished=true})};a.execute=function(){switch(a.action.id){case 0:$.rpijs.get("i2c/byte?address="+a.address,c);break;case 1:$.rpijs.post("i2c/byte?address="+a.address,a.value,b);break;case 2:$.rpijs.get("i2c/register8/"+a.register+"?address="+a.address,c);break;case 3:$.rpijs.post("i2c/register8/"+a.register+"?address="+a.address,a.value,b);break;case 4:$.rpijs.get("i2c/register16/"+a.register+"?address="+a.address,c);break;case 5:$.rpijs.post("i2c/register16/"+a.register+"?address="+a.address,a.value,b);break}};a.buttonClick=function(){a.finished=false}}]);
registerPage({path:"/spi",route:{templateUrl:"partials/spi.html",controller:"SPIController"},accessDependencies:{spi:"write"},title:"SPI",description:"Simultaneously write and read data on SPI bus."});rpiDashboard.controller("SPIController",["$scope",function(a){a.bus=0;a.read="";a.write="";a.finished=false;a.execute=function(){$.rpijs.post("spi/"+a.bus,a.write,function(b){if(b=="SPI setup problem."||b=="SPI bus write failed"){a.status="warning";a.statusText=b}else{a.status="success";a.statusText="Successful!";a.read=b}a.finished=true})};a.buttonClick=function(){a.finished=false;a.read=""};a.busChange=function(){$.rpijs.get("spi/"+a.bus+"/frequency",function(b){a.frequency=b})};a.frequencyStatus=true;a.frequencyChange=function(){if(this.frequency===null){return}if(typeof this.frequency!="number"){this.frequency=500000}$.rpijs.post("spi/"+a.bus+"/frequency",a.frequency,function(b){if(b=="Successful!"){a.frequencyStatus=true}else{a.frequencyStatus=false}})};a.busChange()}]);
registerPage({path:"/serial",route:{templateUrl:"partials/serial.html",controller:"SerialController"},accessDependencies:{serial:"write"},title:"Serial",description:"Send and receive data through serial (UART) port."});rpiDashboard.controller("SerialController",["$scope",function(b){b.active=false;b.read="";b.write="";var a=undefined;b.baud=9600;b.baudOptions=[50,110,300,600,1200,2400,4800,9600,19200,38400,57600,115200];$.rpijs.get("serial/baud",function(d){b.baud=d});b.baudChange=function(){$.rpijs.post("serial/baud",b.baud)};var c=function(){$.rpijs.get("serial/port",function(d){b.$apply(function(){b.read+=d});return b.active},{update:1000})};b.start=function(){b.active=true;a=$.rpijs.websocket("serial/ws",function(d){b.$apply(function(){b.read+=d})});if(a!==undefined){a.onclose=function(){c()}}else{c()}};b.send=function(){if(!b.active){b.start()}$.rpijs.post("serial/port",b.write);b.write=""};b.$on("$destroy",function(){b.active=false;if(a!==undefined){a.close()}})}]);
registerPage({path:"/shift",route:{templateUrl:"partials/shift.html",controller:"ShiftController"},accessDependencies:{shift:"write"},title:"Shift",description:"Shift 8-bits of data in/out on data pin using another pin as a clock."});rpiDashboard.controller("ShiftController",["$scope",function(a){a.actions=[{id:0,text:"Shift in"},{id:1,text:"Shift out"}];a.action=a.actions[0];a.order="msbfirst";a.orders=["msbfirst","lsbfirst"];a.data=1;a.clock=0;a.value=0;a.valueShow=function(){return a.action.id==1};a.finished=false;a.execute=function(){if(a.action.id==0){$.rpijs.post("shift/in",{order:a.order,data:a.data,clock:a.clock},function(b){if(typeof b!="number"){a.status="warning";a.statusText=b}else{a.status="success";a.statusText="Value: "+b}a.finished=true})}else{$.rpijs.post("shift/out",{order:a.order,data:a.data,clock:a.data,value:a.value},function(b){if(b!="Successful!"){a.status="warning"}else{a.status="success"}a.statusText=b;a.finished=true})}};a.buttonClick=function(){a.finished=false}}]);
